2025-08-05 13:41:10,763 - nascar_training - INFO - Training session started at 2025-08-05 13:41:10.763928
2025-08-05 13:41:10,764 - nascar_training - INFO - Log file: logs/nascar_training_20250805_134110.log
2025-08-05 13:41:10,764 - nascar_training - INFO - STEP 1: Data loading and validation
2025-08-05 13:41:10,771 - data.data_loader - INFO - Loading data from Parquet: data/raw/cup_series.parquet
2025-08-05 13:41:10,922 - data.data_loader - INFO - Loaded 99645 records from 1949 to 2025
2025-08-05 13:41:10,927 - data.data_loader - INFO - Date filtering: 99645 -> 99645 records
2025-08-05 13:41:10,938 - data.data_loader - INFO - Missing data removal: 99645 -> 99645 records
2025-08-05 13:41:12,779 - data.data_loader - INFO - Created season summaries for 9787 driver-seasons
2025-08-05 13:41:12,820 - nascar_training - INFO - STEP 2: Feature engineering
2025-08-05 13:41:12,820 - data.data_loader - INFO - Loading data from Parquet: data/raw/cup_series.parquet
2025-08-05 13:41:12,838 - data.data_loader - INFO - Loaded 99645 records from 1949 to 2025
2025-08-05 13:41:12,843 - data.data_loader - INFO - Date filtering: 99645 -> 99645 records
2025-08-05 13:41:12,853 - data.data_loader - INFO - Missing data removal: 99645 -> 99645 records
2025-08-05 13:41:14,768 - data.data_loader - INFO - Created season summaries for 9787 driver-seasons
2025-08-05 13:41:14,771 - data.feature_engineering - INFO - 🔧 Starting comprehensive feature engineering pipeline...
2025-08-05 13:41:14,772 - data.feature_engineering - INFO - Creating rolling window features...
2025-08-05 13:41:32,433 - data.feature_engineering - INFO - Added rolling features for 3 window sizes
2025-08-05 13:41:32,482 - data.feature_engineering - INFO - Identifying career phases...
2025-08-05 13:41:35,151 - data.feature_engineering - INFO - Career phases identified
2025-08-05 13:41:35,151 - data.feature_engineering - INFO - Calculating performance trends...
2025-08-05 13:41:42,689 - data.feature_engineering - INFO - Performance trends calculated
2025-08-05 13:41:42,701 - data.feature_engineering - INFO - Detecting peak performance periods...
2025-08-05 13:41:46,792 - data.feature_engineering - INFO - Peak performance detection completed
2025-08-05 13:41:46,793 - data.feature_engineering - INFO - Calculating consistency metrics...
2025-08-05 13:41:50,715 - data.feature_engineering - INFO - Consistency metrics calculated
2025-08-05 13:41:50,727 - data.feature_engineering - INFO - Creating lag features for [1, 2, 3] seasons...
2025-08-05 13:41:58,891 - data.feature_engineering - INFO - Lag features created
2025-08-05 13:41:58,903 - data.feature_engineering - INFO - ✅ Feature engineering complete!
2025-08-05 13:41:58,903 - data.feature_engineering - INFO -    Original features: 16
2025-08-05 13:41:58,903 - data.feature_engineering - INFO -    Engineered features: 176
2025-08-05 13:41:58,903 - data.feature_engineering - INFO -    Added features: 160
2025-08-05 13:41:58,903 - data.feature_engineering - INFO - Creating LSTM sequences with length 5...
2025-08-05 13:42:00,684 - data.feature_engineering - INFO - Created 3069 LSTM sequences for 437 drivers
2025-08-05 13:42:00,774 - data.feature_engineering - INFO - LSTM sequences saved to data/processed/lstm_sequences.npz
2025-08-05 13:42:00,775 - data.feature_engineering - INFO - Engineered features saved to data/processed/engineered_features.parquet
2025-08-05 13:42:00,781 - nascar_training - INFO - STEP 3: Driver archetype clustering
2025-08-05 13:42:00,781 - data.data_loader - INFO - Loading data from Parquet: data/raw/cup_series.parquet
2025-08-05 13:42:00,802 - data.data_loader - INFO - Loaded 99645 records from 1949 to 2025
2025-08-05 13:42:00,807 - data.data_loader - INFO - Date filtering: 99645 -> 99645 records
2025-08-05 13:42:00,814 - data.data_loader - INFO - Missing data removal: 99645 -> 99645 records
2025-08-05 13:42:02,648 - data.data_loader - INFO - Created season summaries for 9787 driver-seasons
2025-08-05 13:42:02,651 - models.clustering - INFO - Preparing clustering features from driver seasons
2025-08-05 13:42:04,137 - models.clustering - INFO - Prepared features for 975 drivers
2025-08-05 13:42:04,141 - models.clustering - INFO - Selected 11 features for clustering
2025-08-05 13:42:04,141 - models.clustering - INFO - Finding optimal number of clusters...
2025-08-05 13:42:04,582 - models.clustering - INFO - Clusters: 2, Inertia: 8198.74, Silhouette: 0.419
2025-08-05 13:42:04,659 - models.clustering - INFO - Clusters: 3, Inertia: 7212.35, Silhouette: 0.191
2025-08-05 13:42:04,747 - models.clustering - INFO - Clusters: 4, Inertia: 6437.32, Silhouette: 0.160
2025-08-05 13:42:04,868 - models.clustering - INFO - Clusters: 5, Inertia: 5936.91, Silhouette: 0.155
2025-08-05 13:42:04,970 - models.clustering - INFO - Clusters: 6, Inertia: 5489.61, Silhouette: 0.163
2025-08-05 13:42:05,095 - models.clustering - INFO - Clusters: 7, Inertia: 5139.74, Silhouette: 0.178
2025-08-05 13:42:05,325 - models.clustering - INFO - Clusters: 8, Inertia: 4832.27, Silhouette: 0.165
2025-08-05 13:42:05,466 - models.clustering - INFO - Clusters: 9, Inertia: 4592.22, Silhouette: 0.155
2025-08-05 13:42:05,628 - models.clustering - INFO - Clusters: 10, Inertia: 4300.23, Silhouette: 0.170
2025-08-05 13:42:05,629 - models.clustering - INFO - Optimal clusters - Silhouette: 2, Elbow: 5, Config: 6
2025-08-05 13:42:05,629 - models.clustering - INFO - Fitting K-means with 6 clusters
2025-08-05 13:42:05,704 - models.clustering - INFO - Final model - Inertia: 5489.61, Silhouette: 0.163
2025-08-05 13:42:05,755 - models.clustering - INFO - Clustering results saved to data/models/driver_clustering_model.pkl
2025-08-05 13:42:05,755 - models.clustering - INFO - Driver assignments saved to data/processed/driver_archetypes.parquet
2025-08-05 13:42:05,756 - models.clustering - INFO - Cluster analysis saved to data/processed/cluster_analysis.parquet
2025-08-05 13:42:05,764 - nascar_training - INFO - STEP 4: LSTM career trajectory prediction
2025-08-05 13:42:05,765 - models.lstm_model - INFO - TensorFlow version: 2.17.0
2025-08-05 13:42:05,765 - models.lstm_model - INFO - Using import style: 2.x
2025-08-05 13:42:05,769 - models.lstm_model - INFO - No GPUs found, using CPU
2025-08-05 13:42:05,769 - models.lstm_model - INFO - Loaded 3069 sequences with shape (3069, 5, 17)
2025-08-05 13:42:05,769 - models.lstm_model - INFO - Preparing prediction targets...
2025-08-05 13:42:07,832 - models.lstm_model - INFO - Prepared 8 prediction targets
2025-08-05 13:42:07,832 - models.lstm_model - INFO - Preprocessing data for LSTM training...
2025-08-05 13:42:07,837 - models.lstm_model - INFO - Data split - Train: 1964, Val: 491, Test: 614
2025-08-05 13:42:07,837 - models.lstm_model - INFO - Building LSTM model architecture...
2025-08-05 13:42:07,939 - models.lstm_model - INFO - Model architecture:
2025-08-05 13:42:07,943 - models.lstm_model - INFO - Model: "sequential"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ lstm_1 (LSTM)                        │ (None, 5, 64)               │          20,992 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_norm_1 (BatchNormalization)    │ (None, 5, 64)               │             256 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_2 (LSTM)                        │ (None, 32)                  │          12,416 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_norm_2 (BatchNormalization)    │ (None, 32)                  │             128 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_1 (Dense)                      │ (None, 16)                  │             528 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_final (Dropout)              │ (None, 16)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ output (Dense)                       │ (None, 8)                   │             136 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 34,456 (134.59 KB)
 Trainable params: 34,264 (133.84 KB)
 Non-trainable params: 192 (768.00 B)

2025-08-05 13:42:07,943 - models.lstm_model - INFO - Starting LSTM model training...
2025-08-05 13:42:25,458 - models.lstm_model - INFO - Training completed!
2025-08-05 13:42:25,481 - models.lstm_model - INFO - Model saved to data/models/lstm_career_predictor.keras
2025-08-05 13:42:25,481 - models.lstm_model - INFO - Preprocessors saved to data/models/lstm_preprocessors.pkl
2025-08-05 13:42:25,481 - nascar_training - INFO - STEP 5: Finish position prediction model
2025-08-05 13:42:25,481 - nascar_training - ERROR - Pipeline failed at step: FinishPositionPredictor.train() got an unexpected keyword argument 'min_races_for_prediction'
2025-08-05 13:42:25,481 - nascar_training - ERROR - Pipeline failed: FinishPositionPredictor.train() got an unexpected keyword argument 'min_races_for_prediction'
